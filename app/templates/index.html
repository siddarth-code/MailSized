<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta http-equiv="Cache-Control" content="no-store" />
  <title>MailSized – Send Large Videos via Email</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="/static/style.css">

  {{ adsense_tag|safe }}
</head>
<body>
  <div class="container">
    <header>
      <div class="logo" style="display:flex;gap:10px;align-items:center;">
        <div class="logo-icon" style="width:40px;height:40px;border-radius:8px;background:#e6f2ff;display:flex;align-items:center;justify-content:center;">
          <i class="fas fa-video"></i>
        </div>
        <h1 style="font-size:28px;">MailSized</h1>
      </div>
      <p>Compress large videos to fit email attachments</p>

      <div style="display:flex;justify-content:center;gap:15px;margin-top:10px;">
        <div class="constraint"><i class="fas fa-file"></i> <span>≤2GB files</span></div>
        <div class="constraint"><i class="fas fa-clock"></i> <span>≤20 min videos</span></div>
      </div>
    </header>

    <!-- Top step indicator (matches .steps/.step in style.css) -->
    <div class="steps" aria-label="workflow steps">
      <div id="step1" class="step active">1. Upload</div>
      <div id="step2" class="step">2. Payment</div>
      <div id="step3" class="step">3. Compression</div>
      <div id="step4" class="step">4. Download</div>
    </div>

    <div class="card-container" style="display:grid;grid-template-columns:1fr 320px;gap:18px;">
      <!-- LEFT: Main flow -->
      <div class="main-card" style="background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:18px;">
        <div class="step-content">
          <h2 class="step-title" style="display:flex;align-items:center;gap:8px;">
            <i class="fas fa-cloud-upload-alt"></i> 1. Upload Your Video
          </h2>

          <!-- Upload area -->
          <div id="uploadArea" class="upload-area" role="button" tabindex="0">
            <div class="upload-icon" style="font-size:40px;color:#0077cc;margin-bottom:6px;">
              <i class="fas fa-cloud-upload-alt"></i>
            </div>
            <h3 style="margin:4px 0;">Click to browse or drag &amp; drop your video</h3>
            <p>Max file size: 2GB</p>
            <p>Supported formats: MP4, MOV, AVI, MKV</p>
            <input id="fileInput" type="file" accept="video/*" style="display:none;">
          </div>
          <div id="uploadProgress" class="progress-wrapper" style="display:none;">
            <div class="progress-header">
              <span>Uploading…</span>
              <span id="uploadProgressPct">0%</span>
            </div>
            <div class="progress-track">
              <div class="progress-fill" id="uploadProgressFill" style="width:0%;"></div>
            </div>
          </div>

          <!-- Selected file details -->
          <div id="fileInfo" class="file-info" style="display:none;border:1px solid #e5e7eb;border-radius:8px;padding:10px;margin-top:12px;display:flex;align-items:center;gap:10px;">
            <div class="file-icon" style="font-size:22px;color:#555;"><i class="fas fa-file-video"></i></div>
            <div class="file-details" style="flex:1;">
              <div id="fileName" class="file-name" style="font-weight:600;"></div>
              <div class="file-meta" style="display:flex;gap:10px;font-size:13px;color:#555;margin-top:4px;">
                <span id="fileSize"></span>
                <span id="fileDuration"></span>
              </div>
            </div>
            <button id="removeFile" class="remove-file" type="button" aria-label="remove file" title="Remove file" style="border:none;background:#f3f4f6;border-radius:6px;padding:6px 8px;cursor:pointer;">
              <i class="fas fa-times"></i>
            </button>
          </div>

          <h2 class="step-title" style="display:flex;align-items:center;gap:8px;margin-top:18px;">
            <i class="fas fa-envelope"></i> 2. Select Email Provider
          </h2>

          <!-- Providers (buttons with required data-provider) -->
          <div id="providerList" class="providers" role="group" aria-label="email provider">
            <button type="button" class="provider-card selected" data-provider="gmail" aria-pressed="true">
              <div class="provider-icon"><i class="fab fa-google"></i></div>
              <div class="provider-name">Gmail</div>
              <div class="provider-details">
                <div>Max attachment: 25MB</div>
                <div class="provider-price">$1.99 – $4.99</div>
              </div>
            </button>

            <button type="button" class="provider-card" data-provider="outlook" aria-pressed="false">
              <div class="provider-icon"><i class="fab fa-microsoft"></i></div>
              <div class="provider-name">Outlook</div>
              <div class="provider-details">
                <div>Max attachment: 20MB</div>
                <div class="provider-price">$2.19 – $4.99</div>
              </div>
            </button>

            <button type="button" class="provider-card" data-provider="other" aria-pressed="false">
              <div class="provider-icon"><i class="fas fa-envelope"></i></div>
              <div class="provider-name">Other</div>
              <div class="provider-details">
                <div>Max attachment: 15MB</div>
                <div class="provider-price">$2.49 – $5.49</div>
              </div>
            </button>
          </div>

          <h2 class="step-title" style="display:flex;align-items:center;gap:8px;margin-top:18px;">
            <i class="fas fa-star"></i> 3. Add Extras
          </h2>

          <div class="extras" style="display:flex;gap:14px;flex-wrap:wrap;">
            <label class="extra-option" style="display:flex;align-items:center;gap:8px;">
              <input type="checkbox" id="priority">
              <span class="extra-label">Priority Processing</span>
              <span class="extra-price">+ $0.75</span>
            </label>

            <label class="extra-option" style="display:flex;align-items:center;gap:8px;">
              <input type="checkbox" id="transcript">
              <span class="extra-label">Video Transcript</span>
              <span class="extra-price">+ $1.50</span>
            </label>
          </div>

          <!-- optional email -->
          <div class="email-input" style="margin-top:12px;">
            <label for="userEmail">Your email (optional):</label>
            <input id="userEmail" type="email" placeholder="you@example.com" style="width:100%;padding:8px;border:1px solid #e5e7eb;border-radius:6px;margin-top:6px;">
          </div>

          <div class="payment-agreement" style="margin-top:10px;">
            <label style="display:flex;gap:8px;align-items:flex-start;">
              <input type="checkbox" id="agree">
              <span>I agree to the <a class="terms-link" href="/terms" target="_blank" rel="noopener">Terms &amp; Conditions</a> (service is non‑refundable)</span>
            </label>
          </div>

          <!-- Error box (hidden by default via CSS) -->
          <div id="errorContainer" class="error-container" role="alert">
            <div class="error-title" style="font-weight:600;margin-bottom:6px;">
              <i class="fas fa-exclamation-circle"></i> Error
            </div>
            <div id="errorMessage"></div>
          </div>

          <button id="processButton" class="action-button" type="button" style="margin-top:12px;padding:12px 16px;border:none;border-radius:8px;background:#0077cc;color:#fff;font-weight:600;cursor:pointer;">
            <i class="fas fa-credit-card"></i> Pay &amp; Compress
          </button>

          <!-- Post‑payment section -->
          <div id="postPaySection" style="display:none;margin-top:16px;">
            <div class="progress-container">
              <div id="progressFill" class="progress-fill" style="width:0%;"></div>
              <div id="progressPct" class="progress-pct">0%</div>
            </div>
            <div id="progressNote" class="progress-note">Preparing…</div>

            <div id="downloadSection" style="display:none;margin-top:14px;">
              <a id="downloadLink" class="action-button" href="#" download style="display:inline-block;padding:10px 14px;border-radius:8px;background:#28a745;color:#fff;font-weight:600;">
                <i class="fas fa-download"></i> Download Compressed Video
              </a>
              <p style="margin-top:8px;font-size:0.9rem;color:#4a5568;">We’ve also emailed your file.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- RIGHT: Pricing Summary (IDs REQUIRED by script.js) -->
      <aside class="info-card" style="background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:16px;">
        <h2 style="margin-bottom:8px;"><i class="fas fa-receipt"></i> Pricing Details</h2>
        <table class="pricing-table" style="width:100%;border-collapse:collapse;">
          <thead>
            <tr><th>Duration</th><th>Max Size</th><th>Gmail</th><th>Outlook</th><th>Other</th></tr>
          </thead>
          <tbody>
            <tr><td>≤5 min</td><td>≤500 MB</td><td>$1.99</td><td>$2.19</td><td>$2.49</td></tr>
            <tr><td>≤10 min</td><td>≤1 GB</td><td>$2.99</td><td>$3.29</td><td>$3.99</td></tr>
            <tr><td>≤20 min</td><td>≤2 GB</td><td>$4.99</td><td>$4.99</td><td>$5.49</td></tr>
          </tbody>
        </table>

        <div class="price-summary" style="margin-top:10px;">
          <div class="price-row"><span>Base compression:</span> <span id="basePrice">$0.00</span></div>
          <div class="price-row"><span>Priority Processing:</span> <span id="priorityPrice">$0.00</span></div>
          <div class="price-row"><span>Transcript:</span> <span id="transcriptPrice">$0.00</span></div>
          <div class="price-row"><span>Estimated tax (10%):</span> <span id="taxAmount">$0.00</span></div>
          <div class="price-row" style="font-weight:700;"><span>Total:</span> <span id="totalAmount">$0.00</span></div>
        </div>

        <!-- Optional ad slots -->
        <div id="ad-slot-sidebar" class="hidden lg:block w-full rounded-2xl shadow-sm p-4 border bg-white" style="min-height:180px;margin-top:15px;" data-ad-slot="sidebar-300x250">
          <div class="text-sm text-gray-500">Sponsored • placeholder</div>
        </div>
      </aside>
    </div>
  </div>

  <!-- IMPORTANT: keep the version query so browsers bust cache after deploys -->
  <script defer src="/static/script.js?v=2025-08-14-6"></script>

  <script>
    /* Optional AdSense bootstrapping (safe if ads not enabled) */
    if (window.adsbygoogle) {
      const slots=[{id:'ad-slot-sidebar',slot:'sidebar-300x250'}];
      slots.forEach(s=>{
        const el=document.getElementById(s.id); if(!el) return;
        const ins=document.createElement('ins');
        ins.className='adsbygoogle'; ins.style.display='block';
        ins.setAttribute('data-ad-client','{{ adsense_client_id }}');
        ins.setAttribute('data-ad-slot',s.slot);
        ins.setAttribute('data-full-width-responsive','true');
        el.innerHTML=''; el.appendChild(ins);
        (adsbygoogle=window.adsbygoogle||[]).push({});
      });
    }
  </script>
</body>
</html>
